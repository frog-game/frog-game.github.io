[{"content":" å®‰è£…ç¯å¢ƒ ç‰ˆæœ¬ Ubuntu 20.04 zabbix 6.0 mysql 8.0 zabbix 6.0 é˜¿é‡Œäº‘é•œåƒåœ°å€ https://mirrors.aliyun.com/zabbix/zabbix/6.0/ubuntu/pool/main/z/zabbix-release/ ä¸‹è½½ zabbix sudo wget https://repo.zabbix.com/zabbix/6.0/ubuntu/pool/main/z/zabbix-release/zabbix-release_6.0-1+ubuntu20.04_all.deb sudo dpkg -i zabbix-release_6.0-1+ubuntu20.04_all.deb sudo apt update å®‰è£…Zabbix serverï¼ŒWebå‰ç«¯ï¼Œagent sudo apt install zabbix-server-mysql zabbix-frontend-php zabbix-apache-conf zabbix-sql-scripts zabbix-agent åˆ›å»ºåˆå§‹æ•°æ®åº“ mysql -uroot -p123456 mysql\u0026gt; create database zabbix character set utf8mb4 collate utf8mb4_bin; mysql\u0026gt; create user zabbix@`%` identified by \u0026#39;123456\u0026#39;; mysql\u0026gt; grant all privileges on zabbix.* to zabbix@`%`; mysql\u0026gt; quit; å¯¼å…¥åˆå§‹æ¶æ„å’Œæ•°æ®ï¼Œç³»ç»Ÿå°†æç¤ºæ‚¨è¾“å…¥æ–°åˆ›å»ºçš„å¯†ç [é»˜è®¤å¯†ç ç°åœ¨è®¾ç½®ä¸º 123456 zcat /usr/share/doc/zabbix-sql-scripts/mysql/server.sql.gz | mysql -uzabbix -p -h10.40.38.67 zabbix # æŒ‡å®šæœ¬åœ°çš„IPåœ°å€ï¼Œä¸é»˜è®¤å°±ä¼šæŒ‡å‘æœ¬åœ°localhost å¦‚æœæŠ¥ERROR 2003 (HY000): Can't connect to MySQL server on '10.40.38.67:3306' (111) çœ‹ç¬¬5ç« mysqlæ“ä½œæŒ‡å¯¼ï¼Œå¤šåŠæ˜¯å› ä¸ºæƒé™å’Œå¯†ç é—®é¢˜\nä¸ºZabbix serveré…ç½®æ•°æ®åº“ sudo vim /etc/zabbix/zabbix_server.conf ä¿®æ”¹ DBPassword=123456 å¯åŠ¨Zabbix serverå’Œagentè¿›ç¨‹ sudo systemctl restart zabbix-server zabbix-agent apache2 grafana-server sudo systemctl enable zabbix-server zabbix-agent apache2 grafana-server è¿æ¥webå‰ç«¯[10.40.38.67 æ¢æˆä½ çš„ipåœ°å€] [ç”¨è°·æ­Œæµè§ˆå™¨æˆ–è€…microsoft Edgeæµè§ˆå™¨æ‰“å¼€] http://10.40.38.67/zabbix é»˜è®¤çš„ç”¨æˆ·åæ˜¯Admin(Aæ˜¯å¤§å†™)ï¼ŒPasswordï¼šzabbix ä¿®æ”¹æ—¶åŒº sudo vi /etc/apache2/conf-enabled/zabbix.conf ä¿®æ”¹æ ‡å‡†æ—¶åŒºä¸º Asia/Shanghai ä¸­æ–‡æ˜¾ç¤º sudo apt install language-pack-zh-hans #å®‰è£…ä¸­æ–‡è¯­è¨€åŒ… sudo vim /etc/locale.gen #æ‰¾åˆ°zh_CN.UTF-8 UTF-8 å¹¶å–æ¶ˆ#å·æ³¨é‡Šï¼Œç„¶åä¿å­˜å¹¶é€€å‡º sudo locale-gen #ç¼–è¯‘è¯­è¨€åŒ… sudo vim /etc/default/locale #ä¿®æ”¹é»˜è®¤è¯­è¨€ä¸ºä¸­æ–‡ï¼Œå°†åŸæ¥çš„å†…å®¹æ”¹ä¸º LANG=zh_CN.UTF-8 å®‰è£…å‡ºç°çš„é—®é¢˜ Minimum required size of PHP post is 16M (configuration option \u0026ldquo;post_max_size\u0026rdquo;). è§£å†³æ­¥éª¤ï¼š\nsudo vi /etc/php/8.1/apache2/php.ini post_max_size8M 16M\nmax_execution_time30 300\nmax_input_time60 300\ndate.timezone = Asia/Shanghai\nsudo systemctl restart zabbix-server zabbix-agent apache2 grafana-server ERROR 1396 (HY000): Operation CREATE USER failed for 'zabbix'@'%' mysql\u0026gt; create user zabbix@`%` identified by \u0026#39;123456\u0026#39;; ERROR 1396 (HY000): Operation CREATE USER failed for \u0026#39;zabbix\u0026#39;@\u0026#39;%\u0026#39; åŸå› åˆ†æï¼š\nå·²ç»å­˜åœ¨äº†zabbixç”¨æˆ· åœ¨æ‰§è¡Œåˆ é™¤zabbixç”¨æˆ·çš„æ—¶å€™æ²¡æœ‰åˆ é™¤å¹²å‡€ è§£å†³æ–¹æ³•ï¼š\né‡æ–°è¿›è¡Œåˆ é™¤ã€‚\ndrop user zabbix@\u0026#39;%\u0026#39;; flush privileges; å¸è½½ zabbix åˆ é™¤è½¯ä»¶\nsudo apt-get --purge remove zabbix-server-mysql -y sudo apt-get autoremove zabbix-server-mysql -y sudo apt-get --purge remove zabbix-frontend-php -y sudo apt-get autoremove zabbix-frontend-php -y sudo apt-get --purge remove abbix-apache-conf -y sudo apt-get autoremove abbix-apache-conf -y sudo apt-get --purge remove zabbix-agent -y #åˆ é™¤è½¯ä»¶å…¶é…ç½® sudo apt-get autoremove zabbix-agent -y #åˆ é™¤è½¯ä»¶ä¾èµ–åŒ… æ¸…ç†æ•°æ®\nsudo dpkg -l |grep ^rc|awk \u0026#39;{print $2}\u0026#39; |sudo xargs dpkg -P åˆ é™¤ä»¥ä¸Šapt-getä¸‹è½½çš„è½¯ä»¶åŒ…\nsudo apt-get autoclean åˆ é™¤ç¼“å­˜çš„æ‰€æœ‰è½¯ä»¶åŒ…\nsudo apt-get clean åˆ é™¤å…¶ä»–è½¯ä»¶ä¾èµ–çš„ä½†ç°åœ¨å·²ä¸ç”¨çš„è½¯ä»¶åŒ…ï¼ˆä¿ç•™é…ç½®æ–‡ä»¶ï¼‰\n```sh sudo apt-get autoremove ``` æŸ¥è¯¢å‡ºå†—ä½™æ–‡ä»¶å¹¶åˆ é™¤\nsudo find / -name zabbix æ‰§è¡Œrm-rf åˆ é™¤å†—ä½™æ–‡ä»¶\nsudo rm -rf /run/zabbix sudo rm -rf /etc/zabbix sudo rm -rf /usr/share/zabbix sudo rm -rf /var/log/zabbix sudo rm -rf /var/lib/mysql/zabbix åˆ é™¤åŒ…å«zabbixå…³é”®å­—çš„æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹\n```sh sudo find / -name \u0026quot;zabbix*\u0026quot; | sudo xargs rm -rf ``` grafana ä¸‹è½½grafana debå®‰è£…åŒ… sudo apt-get install -y adduser libfontconfig1 sudo wget https://dl.grafana.com/enterprise/release/grafana-enterprise_8.5.4_amd64.deb sudo dpkg -i grafana-enterprise_8.5.4_amd64.deb å¯åŠ¨grafana-server sudo systemctl restart grafana-server sudo systemctl enable grafana-server å®‰è£…zabbixæ’ä»¶ grafana-cli plugins list-remote sudo grafana-cli plugins install alexanderzobnin-zabbix-app #é‡å¯grafana-server sudo systemctl restart grafana-server ä¹Ÿå¯ä»¥åœ¨grafana-\u0026gt;pluginsè¿™é‡Œå®‰è£…\nç™»å½•grafanaæœåŠ¡å™¨[10.40.38.67 æ¢æˆä½ çš„ipåœ°å€] [ç”¨è°·æ­Œæµè§ˆå™¨æˆ–è€…microsoft Edgeæµè§ˆå™¨æ‰“å¼€] http:/10.40.38.67:3000/ #é»˜è®¤ç”¨æˆ·åå’Œå¯†ç ä¸ºadminã€admin grafana é…ç½®zabbixæ•°æ®æº grafana é…ç½®zabbixç›‘æ§é¢æ¿ åœ¨ç‚¹å‡»å®Œnew dashboard æŒ‰é’®ä»¥å æŒ‰ctrl + s ä¿å­˜ä¸€ä¸ªè‡ªå·±å®šä¹‰çš„ä»ªè¡¨ç›˜\ngrafanaå¢åŠ ä¸»é¢˜ å®‰è£…æ’ä»¶ï¼šgrafana-cli plugins install yesoreyeram-boomtheme-panel grafanaä¸»é¢˜åœ°å€ï¼šhttps://github.com/charles1503/grafana-theme/tree/master/CSS/themes/grafanas grafanaæ›´æ”¹ä¸»é¢˜æ•™ç¨‹ï¼šhttps://www.bilibili.com/read/cv7004400 è§†é¢‘æ•™ç¨‹ï¼šhttps://cloud.tencent.com/developer/video/11330 http://10.40.38.67:3000/public/themes/aquamarine.css å…·ä½“æ“ä½œæ­¥éª¤ï¼š\nåˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œç”¨äºå­˜æ”¾ä¸‹è½½å¯¹åº”ä¸»é¢˜çš„cssæ–‡ä»¶\nsudo mkdir /usr/share/grafana/public/themes/ cd /usr/share/grafana/public/themes/ ä½¿ç”¨ä¸€ä¸ªfor å¾ªç¯ä¸‹è½½å¯¹åº”çš„æ‰€æœ‰ä¸»é¢˜cssæ–‡ä»¶\nfor f in grafana-base.css aquamarine.css hotline.css dark.css plex.css space-gray.css organizr-dashboard.css;do wget https://raw.githubusercontent.com/505384662/grafana-theme/master/CSS/themes/grafana/$f;done ä¸ºGrafanaå®‰è£…ç¤¾åŒºæ’ä»¶Boom Theme\nsudo grafana-cli plugins install yesoreyeram-boomtheme-panel sudo systemctl restart grafana-server åœ¨Dashboardä¸­æ·»åŠ Boom Theme\ngrafana ä¸»é¢˜ä¿®æ”¹åœ°å€ cd /usr/share/grafana/public/themes grafana åŠ æ—¶é’Ÿ grafana-cli plugins install grafana-clock-panel systemctl restart grafana-server grafana flowchartingå®‰è£… sudo grafana-cli plugins install agenty-flowcharting-panel sudo systemctl restart grafana-server grafana ä¿®æ”¹æ¨¡æ¿åœ°å€ https://grafana.com/grafana/dashboards zabbix ä¿®æ”¹é…ç½®åœ°å€ï¼šhttp://192.168.70.130/zabbix/setup.php zabbix å±•ç¤ºåœ°å€ï¼šhttp://192.168.70.130/zabbix/zabbix.php?action=dashboard.view grafana å±•ç¤ºåœ°å€: http://192.168.70.130:3000/d/tYxzFya7z/test_zabbix?orgId=1 Grafana åŒ¿åè®¿é—®ï¼ˆå…ç™»å½•ï¼‰ ä¿®æ”¹Grafanaé…ç½®æ–‡ä»¶\nåœ¨Grafanaçš„é…ç½®æ–‡ä»¶ /etc/grafana/grafana.ini ä¸­ï¼Œæ‰¾åˆ° [auth.anonymous] é…ç½®å—ï¼Œå°†å…¶ä¸‹çš„åŒ¿åè®¿é—®æ§åˆ¶ enabled è®¾ç½®ä¸º trueï¼Œç»„ç»‡æƒé™è®¾ç½®ä¸º Viewer\nViewer:**åªè¯»**æ¨¡å¼\nEditor:**å¯ç¼–è¾‘**æ¨¡å¼\nAdmin:**ç®¡ç†å‘˜**æ¨¡å¼\n#################################### Anonymous Auth ###################### # Set to true to disable (hide) the login form, useful if you use OAuth, defaults to false disable_login_form = true [auth.anonymous] # enable anonymous access enabled = true # specify organization name that should be used for unauthenticated users org_name = Main Org. # specify role for unauthenticated users org_role = Viewer é‡å¯GrafanaæœåŠ¡\nä¿®æ”¹å®Œé…ç½®æ–‡ä»¶ï¼Œé‡å¯GrafanaæœåŠ¡ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š\nsudo systemctl restart grafana-server å¸è½½ grafana æŸ¥æ‰¾åˆ°å®‰è£…è½¯ä»¶å\nsudo dpkg -l | grep grafana åˆ é™¤è½¯ä»¶\n```sh sudo dpkg -r grafana-enterprise ``` æŸ¥è¯¢å‡ºå†—ä½™æ–‡ä»¶å¹¶åˆ é™¤\nfind / -name grafana ç”¨rm-rf å‘½ä»¤åˆ é™¤\nrm -rf /etc/grafana rm -rf /usr/share/grafana rm -rf /usr/share/grafana/public/themes/grafana-theme/CSS/themes/grafana rm -rf /var/log/grafana rm -rf /var/lib/grafana apache2 apache2å¯åŠ¨æŠ¥é”™ å¤§è‡´æ„æ€æ²¡æœ‰å¯¼å…¥apache ç¯å¢ƒå˜é‡ è§£å†³åŠæ³•:\nsource /etc/apache2/envvars è¿˜æ˜¯æŠ¥é”™\nå¤§è‡´æ„æ€æ˜¯80ç«¯å£è¢«å ç”¨äº† æˆ‘é€‰æ‹©çš„æ–¹æ³•æ˜¯killå ç”¨è¿›ç¨‹åœ¨é‡å¯\nroot@hls:/root# netstat -lnp|grep 80 tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN 950/nginx: master p tcp6 0 0 :::80 :::* LISTEN 950/nginx: master p unix 2 [ ACC ] STREAM LISTENING 41930 1228/zabbix-plugin_ /tmp/plugin835680808 root@hls:/root# kill -9 950 root@hls:/root# systemctl restart zabbix-server zabbix-agent apache2 å¸è½½apache2 åˆ é™¤è½¯ä»¶\n//1. åˆ é™¤apache sudo apt-get --purge remove apache2 sudo apt-get --purge remove apache2.2-common //2.æ‰¾åˆ°æ²¡æœ‰åˆ é™¤æ‰çš„é…ç½®æ–‡ä»¶ï¼Œä¸€å¹¶åˆ é™¤ sudo find /etc -name \u0026#34;*apache*\u0026#34; |xargs rm -rf sudo rm -rf /var/www sudo rm -rf /etc/libapache2-mod-jk //3.åˆ é™¤å…³è”ï¼Œè¿™æ ·å°±å¯ä»¥å†æ¬¡ç”¨apt-get install apache2 é‡è£…äº† #dpkg -l |grep apache2|awk \u0026#39;{print $2}\u0026#39;|xargs dpkg -P//æ³¨æ„ï¼šè¿™ä¸€æ­¥å¯èƒ½ä¼šæŠ¥é”™ï¼Œä½†ä¹Ÿæ²¡å…³ç³» æŸ¥è¯¢å‡ºå†—ä½™æ–‡ä»¶å¹¶åˆ é™¤\nsudo find / -name apache2 ç”¨rm -rf å‘½ä»¤åˆ é™¤\nNginx å®˜ç½‘ä¸‹è½½åœ°å€ http://nginx.org/en/download.html ä¸€äº›ç¯å¢ƒå‡†å¤‡ å®‰è£…ç¼–è¯‘å·¥å…·\nsudo apt-get install build-essential å®‰è£…ç¼–è¯‘å·¥å…· å®‰è£…gccä»€ä¹ˆçš„å¥½ä¾¿äºä¸‹é¢ç¼–è¯‘å®‰è£… å®‰è£…pcreåŒ…\nsudo apt-get update sudo apt-get install libpcre3 libpcre3-dev sudo apt-get install openssl libssl-dev å®‰è£… zlib åº“\nsudo apt install zlib1g-dev ä¸‹è½½å®‰è£…Nginx sudo wget http://nginx.org/download/nginx-1.21.6.tar.gz sudo tar -xzvf nginx-1.21.6.tar.gz cd nginx-1.21.6 sudo ./configure --prefix=/usr/local/nginx --with-http_ssl_module --with-stream --with-mail=dynamic #æœ€å¥½ç”¨ --prefixæŒ‡å®šè·¯å¾„ï¼Œä¾¿äºåé¢åˆ é™¤[åªéœ€è¦åˆ é™¤prefixæŒ‡å®šçš„æ–‡ä»¶å¤¹å°±è¡Œäº†]ï¼Œä¸æŒ‡å®šçš„è¯åé¢åˆ é™¤æ¯”è¾ƒéº»çƒ¦ sudo make sudo make install åˆ¶ä½œè½¯è¿æ¥ ln -s /usr/local/nginx/sbin/nginx /usr/local/sbin/ é…ç½®ç¯å¢ƒå˜é‡ ç¼–è¾‘/etc/profileå¹¶ä¸”è¿½åŠ Nginxçš„ç¯å¢ƒå˜é‡ # nginx export NGINX_HOME=/usr/local/nginx export PATH=$PATH:$NGINX_HOME/sbin ç”Ÿæ•ˆç¯å¢ƒå˜é‡ source /etc/profile æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ nginx -v å¯åŠ¨Nginx sudo nginx å¼ºåˆ¶åœæ­¢Nginx sudo pkill -9 nginx æŸ¥çœ‹Nginxè¿›ç¨‹ ps aux|grep nginx é…ç½®é˜²ç«å¢™ sudo ufw allow \u0026#39;Nginx Full\u0026#39; éªŒè¯é˜²ç«å¢™æ˜¯å¦å…è®¸ å‡ºç°ä¸‹é¢ä¸¤ç§æƒ…å†µéƒ½è®¤ä¸ºå¯ä»¥ Status: active To Action From -- ------ ---- 22/tcp ALLOW Anywhere Nginx Full ALLOW Anywhere 22/tcp (v6) ALLOW Anywhere (v6) Nginx Full (v6) ALLOW Anywhere (v6) sudo ufw status çŠ¶æ€ï¼šä¸æ´»åŠ¨ æµ‹è¯•è®¿é—® http://192.168.70.132:7000 Nginx ç›¸å…³æ–‡ä»¶ä½ç½® nginx path prefix: \u0026#34;/usr/local/nginx\u0026#34; nginx binary file: \u0026#34;/usr/local/nginx/sbin/nginx\u0026#34; nginx modules path: \u0026#34;/usr/local/nginx/modules\u0026#34; nginx configuration prefix: \u0026#34;/usr/local/nginx/conf\u0026#34; nginx configuration file: \u0026#34;/usr/local/nginx/conf/nginx.conf\u0026#34; nginx pid file: \u0026#34;/usr/local/nginx/logs/nginx.pid\u0026#34; nginx error log file: \u0026#34;/usr/local/nginx/logs/error.log\u0026#34; nginx http access log file: \u0026#34;/usr/local/nginx/logs/access.log\u0026#34; nginx http client request body temporary files: \u0026#34;client_body_temp\u0026#34; nginx http proxy temporary files: \u0026#34;proxy_temp\u0026#34; nginx http fastcgi temporary files: \u0026#34;fastcgi_temp\u0026#34; nginx http uwsgi temporary files: \u0026#34;uwsgi_temp\u0026#34; nginx http scgi temporary files: \u0026#34;scgi_temp\u0026#34; å¸è½½ Nginx sudo rm -rf /usr/local/nginx sudo rm -rf /usr/local/nginx/sbin/nginx #è½¯è¿æ¥ä¹Ÿè®°å¾—åˆ é™¤ å¦‚æœæƒ³å®Œå…¨å¹²å‡€ï¼Œ/etc/profile é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šçš„ç¯å¢ƒå˜é‡ä¹Ÿå¯ä»¥åˆ é™¤ mysql å®‰è£…mysql sudo apt update sudo apt install mysql-server å®‰è£…å®Œæˆåï¼ŒMySQLæœåŠ¡å°†è‡ªåŠ¨å¯åŠ¨ã€‚è¦éªŒè¯MySQLæœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼Œè¯·è¾“å…¥ï¼š\nsudo systemctl status mysql å½»åº•å¸è½½mysqlæ–¹æ³• æŸ¥çœ‹ä¾èµ–åŒ…\ndpkg --list | grep mysql å…ˆä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤\nsudo apt-get remove mysql-common sudo apt-get autoremove --purge mysql-server-5.0 # å¸è½½ MySQL 5.x ä½¿ç”¨, é5.xç‰ˆæœ¬å¯è·³è¿‡è¯¥æ­¥éª¤ sudo apt-get autoremove --purge mysql-server ç„¶åå†ç”¨\ndpkg --list | grep mysql æŸ¥çœ‹ä¸€ä¸‹ä¾èµ–åŒ…æœ€åç”¨ä¸‹é¢å‘½ä»¤æ¸…é™¤æ®‹ç•™æ•°æ®\ndpkg -l |grep ^rc|awk \u0026#39;{print $2}\u0026#39; |sudo xargs dpkg -P æŸ¥çœ‹ä»MySQL APTå®‰è£…çš„è½¯ä»¶åˆ—è¡¨, æ‰§è¡Œåæ²¡æœ‰æ˜¾ç¤ºåˆ—è¡¨, è¯æ˜MySQLæœåŠ¡å·²å®Œå…¨å¸è½½\ndpkg -l | grep mysql | grep i åšå®¢åœ°å€\nhttps://blog.csdn.net/PY0312/article/details/89481421 MySQLåœ¨Ubuntuä¸Šå¯åŠ¨å‡ºé”™Could not open â€˜abstractions/mysqlâ€˜ rm -rf /etc/apparmor.d/abstractions/mysql rm -rf /etc/apparmor.d/cache/usr.sbin.mysqld find / -name \u0026#39;mysql*\u0026#39; -exec rm -rf {} \\; è¿æ¥MySqlæŠ¥é”™â€œcan\u0026rsquo;t connect to local mysql server through socket \u0026lsquo;/var/run/mysqld/mysqld.sock\u0026rsquo; cd /etc/init.d sudo service mysql stop sudo service mysql start mysql Ubuntu 20.04 Access denied for user \u0026lsquo;root\u0026rsquo;@\u0026rsquo;localhost é¦–å…ˆè¾“å…¥ä»¥ä¸‹æŒ‡ä»¤ è·å–å¯†ç ï¼š\nsudo cat /etc/mysql/debian.cnf å†è¾“å…¥ä»¥ä¸‹æŒ‡ä»¤è¿›å…¥mysql\næŸ¥è¯¢userå…³é”®å­—æ®µ\nselect user, authentication_string,plugin,Host from mysql.user; ä¿®æ”¹å¯†ç æ ¼å¼\nuse mysql; update user set plugin=\u0026#39;mysql_native_password\u0026#39; where user=\u0026#39;root\u0026#39;; flush privileges; ä¿®æ”¹å¯†ç \nuse mysql; ALTER USER \u0026#39;root\u0026#39;@\u0026#39;localhost\u0026#39; IDENTIFIED WITH mysql_native_password BY \u0026#39;123456\u0026#39;; flush privileges; è¾“å…¥\nmysql -uroot -p123456; æŸ¥çœ‹æ•ˆæœ è®©åˆ«çš„ipèƒ½è¿ä¸Šwslæ•°æ®åº“\nuse mysql; update user set Host=\u0026#39;%\u0026#39; where user=\u0026#39;root\u0026#39;; flush privileges; è¾“å…¥\nselect user, authentication_string,plugin,Host from mysql.user; æŸ¥çœ‹æ•ˆæœ\nå¼€å¯è¿œç¨‹è®¿é—®\nsudo vi /etc/mysql/mysql.conf.d/mysqld.cnf # æ³¨é‡Š bind-address = 127.0.0.1 é‡å¯mysql\nsudo service mysql restart æ•ˆæœ\nELK ä¸€äº›å‡†å¤‡ å®˜ç½‘åœ°å€ https://www.elastic.co/guide/en/elasticsearch/reference/8.0/deb.html#deb-repo è™šæ‹Ÿæœº æƒ³è¦å¤šå¼€æœ€å¥½æ˜¯å…‹éš†ä¸€ä»½å‡ºæ¥ æ¯”å¦‚2å°±æ˜¯å…‹éš†çš„1çš„é•œåƒ\nä¿®æ”¹ å…‹éš†çš„è™šæ‹Ÿæœºç½‘å¡åœ°å€\nsudo vim /etc/netplan/00-installer-config.yaml ä¿®æ”¹å†…å®¹:\nnetwork: ethernets: ens33: #é…ç½®çš„ç½‘å¡çš„åç§° addresses: [192.168.70.130/24] #é…ç½®çš„é™æ€ipåœ°å€å’Œæ©ç  dhcp4: no #å…³é—­DHCPï¼Œå¦‚æœéœ€è¦æ‰“å¼€DHCPåˆ™å†™yes optional: true gateway4: 192.168.70.2 #ç½‘å…³åœ°å€ nameservers: addresses: [192.168.70.2,114.114.114.114] #DNSæœåŠ¡å™¨åœ°å€ï¼Œå¤šä¸ªDNSæœåŠ¡å™¨åœ°å€éœ€è¦ç”¨è‹±æ–‡é€—å·åˆ†éš”å¼€ version: 2 renderer: networkd #æŒ‡å®šåç«¯é‡‡ç”¨systemd-networkdæˆ–è€…Network Managerï¼Œå¯ä¸å¡«å†™åˆ™é»˜è®¤ä½¿ç”¨systemd-workd ä½¿é…ç½®ç”Ÿæ•ˆ\nsudo netplan apply æ³¨æ„äº‹é¡¹\n1ã€ipåœ°å€å’ŒDNSæœåŠ¡å™¨åœ°å€éœ€è¦ç”¨[]æ‹¬èµ·æ¥ï¼Œä½†æ˜¯ç½‘å…³åœ°å€ä¸éœ€è¦ 2ã€æ³¨æ„æ¯ä¸ªå†’å·åè¾¹éƒ½è¦å…ˆåŠ ä¸€ä¸ªç©ºæ ¼ 3ã€æ³¨æ„æ¯ä¸€å±‚å‰è¾¹çš„ç¼©è¿›ï¼Œè‡³å°‘æ¯”ä¸Šä¸€å±‚å¤šä¸¤ä¸ªç©ºæ ¼ å®‰è£…javaç¯å¢ƒ å®‰è£…java sudo apt install openjdk-8-jdk æŸ¥çœ‹java ç‰ˆæœ¬\nsudo java -version æŸ¥çœ‹ java è·¯å¾„\nsudo which java ls -l /usr/bin/java çœ‹çœ‹è¿™æ˜¯å¦æ˜¯ä¸ªè½¯è¿æ¥ï¼Œæ‰¾å‡ºè¿™ä¸ªè½¯è¿æ¥æŒ‡å‘çš„è·¯å¾„\nls -l /usr/bin/java çš„ç¡®ä¸ºè½¯è¿æ¥ï¼Œç»§ç»­å¾€ä¸‹æ‰¾æŒ‡å‘çš„è·¯å¾„\nè‡³æ­¤ï¼Œjava çš„å®‰è£…è·¯å¾„å³ä¸º /usr/lib/jvm/java-11-openjdk-amd64/bin/java\né…ç½® java ç¯å¢ƒ\nsudo vim /etc/profile åœ¨å¼¹å‡ºçš„ vim ç¼–è¾‘å™¨ä¸­è¾“å…¥\n# JAVA JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64 PATH=$JAVA_HOME/bin:$PATH export JAVA_HOME PATH esc é€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œè¾“å…¥ :xåï¼Œå•å‡»å›è½¦é€€å‡ºã€‚\nåœ¨ç»ˆç«¯è¾“å…¥\nsource /etc/profile ä½¿ä¹‹å‰çš„é…ç½®ç”Ÿæ•ˆã€‚\néªŒè¯\njava -version\n$JAVA_HOME/bin/java -version\npython3 [ä¸æ˜¯å¿…é¡»è£…ä¸»è¦æ˜¯æƒ³ä½¿ç”¨ json.tool æ ¼å¼åŒ–è¾“å‡º]\nå®‰è£…python3.8\nsudo apt-get install python3.8 å»ºç«‹è½¯è¿æ¥\nsudo ln -s /usr/bin/python3.8 /usr/bin/python å¦‚æœæƒ³è¦åˆ é™¤è½¯è¿æ¥\nsudo rm -rf /usr/bin/python æ ¼å¼åŒ–è¾“å‡º\ncurl -XGET http://192.168.70.131:9200/_mapping | python -m json.tool Elasticsearch åŸºç¡€çŸ¥è¯† å’Œå…³ç³»å‹æ•°æ®åº“çš„æ¯”è¾ƒ DBMS Elasticsearch database Index table type(åœ¨7.0ä¹‹åtypeä¸ºå›ºå®šå€¼_doc) Row Document Column Field Schema Mapping SQL DSL(Descriptor Structure Language) å®‰è£…Elasticsearch debåŒ…å®‰è£…æ–¹å¼\nsudo wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.2.2-amd64.deb sudo wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.2.2-amd64.deb.sha512 shasum -a 512 -c elasticsearch-8.2.2-amd64.deb.sha512 sudo dpkg -i elasticsearch-8.2.2-amd64.deb æ‰§è¡Œ**sudo dpkg -i elasticsearch-8.2.2-amd64.deb** å›ç”Ÿæˆè¶…çº§ç”¨æˆ·å¯†ç  0NgzdrlHquc1YdXrQout\n--------------------------- Security autoconfiguration information ------------------------------ Authentication and authorization are enabled. TLS for the transport and HTTP layers is enabled and configured. The generated password for the elastic built-in superuser is : 0NgzdrlHquc1YdXrQout If this node should join an existing cluster, you can reconfigure this with \u0026#39;/usr/share/elasticsearch/bin/elasticsearch-reconfigure-node --enrollment-token \u0026lt;token-here\u0026gt;\u0026#39; after creating an enrollment token on your existing cluster. You can complete the following actions at any time: Reset the password of the elastic built-in superuser with \u0026#39;/usr/share/elasticsearch/bin/elasticsearch-reset-password -u elastic\u0026#39;. Generate an enrollment token for Kibana instances with \u0026#39;/usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s kibana\u0026#39;. Generate an enrollment token for Elasticsearch nodes with \u0026#39;/usr/share/elasticsearch/bin/elasticsearch-create-enrollment-token -s node\u0026#39;. ------------------------------------------------------------------------------------------------- ç”Ÿæˆ ca ã€ç”Ÿæˆ è¯ä¹¦\n# ç”Ÿæˆ ca # æ ¹æ®æç¤ºï¼š # è¾“å…¥ ca çš„å¯†ç ï¼ˆå¯†ç ä¸è¦å¿˜è®°ï¼Œåé¢ç”Ÿæˆè¯ä¹¦éœ€è¦ï¼‰ # è¾“å…¥ç”Ÿæˆ ca çš„æ–‡ä»¶åï¼ˆé»˜è®¤ä¼šè®©ä½ è¾“å…¥ elastic-stack-ca.p12ï¼Œè¿™é‡Œå°±æŒ‰ç…§é»˜è®¤çš„æ¥ï¼‰ sudo /usr/share/elasticsearch/bin/elasticsearch-certutil ca # ç”Ÿæˆè¯ä¹¦ # æ ¹æ®æç¤ºï¼š # è¾“å…¥ä¹‹å‰ ca çš„å¯†ç  # è¾“å…¥ç”Ÿæˆè¯ä¹¦çš„æ–‡ä»¶åï¼ˆé»˜è®¤è®©ä½ è¾“å…¥ elastic-certificates.p12ï¼Œè¿™é‡Œå°±æŒ‰ç…§é»˜è®¤çš„æ¥ï¼‰ # è¾“å…¥ç”Ÿæˆè¯ä¹¦çš„å¯†ç ï¼ˆå¯†ç ä¸è¦å¿˜è®°ï¼Œè¿™ä¸ªå¯†ç åœ¨é…ç½® ES keystore çš„æ—¶å€™éœ€è¦ï¼‰ # --ca åé¢çš„æ–‡ä»¶æ˜¯ä¸Šé¢æ­¥éª¤ç”Ÿæˆçš„ elastic-stack-ca.p12 æ–‡ä»¶ï¼Œå¦‚æœä¿®æ”¹äº†çš„è¯ï¼Œè¿™é‡Œä¹Ÿéœ€è¦ä¿®æ”¹ sudo /usr/share/elasticsearch/bin/elasticsearch-certutil cert --ca elastic-stack-ca.p12 â€‹\tä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œä¸€èˆ¬å°† ca ä¸è¯ä¹¦æ”¾åˆ° ~/.config/certs ç›®å½•ä¸‹\n# åˆ›å»ºç›®å½•å¹¶ç§»åŠ¨ ca ä¸è¯ä¹¦ sudo mkdir -p ~/.config/certs \u0026amp;\u0026amp; sudo mv /usr/share/elasticsearch/elastic-stack-ca.p12 /usr/share/elasticsearch/elastic-certificates.p12 ~/.config/certs å¯åŠ¨ Elasticsearch â€‹\t[ä¸ºäº†å®‰å…¨è€ƒè™‘Elasticsearchä¸å…è®¸ä½¿ç”¨rootç”¨æˆ·æ¥å¯åŠ¨]\næ‰“å¼€ elasticsearch é…ç½®æ–‡ä»¶\nsudo vim /etc/elasticsearch/elasticsearch.yml #æ‰“å¼€é…ç½®æ–‡ä»¶ ä¿®æ”¹ netWork.host, http.port å­—æ®µ\nnetwork.host: 10.40.38.66 #æ³¨æ„ network.host:å’Œ10.40.38.66 ä¹‹é—´éœ€è¦ç©ºæ ¼è¦ä¸å¯åŠ¨ä¼šæœ‰é—®é¢˜ï¼Œå› ä¸ºé…ç½®æ–‡ä»¶ç±»å‹ä¸ºkey-valeæ ¼å¼ http.port: 9200 #æ³¨æ„ http.port:å’Œ9200 ä¹‹é—´éœ€è¦ç©ºæ ¼è¦ä¸å¯åŠ¨ä¼šæœ‰é—®é¢˜ï¼Œå› ä¸ºé…ç½®æ–‡ä»¶ç±»å‹ä¸ºkey-valeæ ¼å¼ å› ä¸ºæ˜¯å†…ç½‘æµ‹è¯•æš‚æ—¶å…³é—­ xpack å®‰å…¨éªŒè¯æ–¹é¢é€‰é¡¹,ä»¥åéœ€è¦å†å»å¼€å¯\nå¯åŠ¨Elasticsearch\nsudo systemctl start elasticsearch.service å¼€æœºå¯åŠ¨elasticsearch\nsudo systemctl enable elasticsearch.service è¿æ¥grafana Elasticsearch æ“ä½œå‘½ä»¤ ç”¨jpså‘½ä»¤å…³é—­Elasticsearch\n$ jps | grep Elasticsearch 14542 Elasticsearch kill -9 14542 æŸ¥çœ‹ Elasticsearch ç«¯å£\nsudo netstat -tnlp |grep java æ£€æµ‹æ˜¯å¦å¯åŠ¨æˆåŠŸ\ncurl -XGET \u0026#39;http://192.168.70.131:9200/\u0026#39; -H \u0026#39;Content-Type: application/json\u0026#39; ç”¨journal æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—\nsudo journalctl -f ç”¨ journal æŸ¥çœ‹elasticsearch æœåŠ¡æ—¥å¿—\nsudo journalctl --unit elasticsearch ç”¨journal æŸ¥çœ‹elasticsearch æŒ‡å®šæ—¶é—´èŒƒå›´çš„æ—¥å¿—\nsudo journalctl --unit elasticsearch --since \u0026#34;2022-02-01 18:17:16\u0026#34; æŸ¥çœ‹ elasticsearch.log\nsudo vim /var/log/elasticsearch/elasticsearch.log Elasticsearch å¸è½½ # æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶ sudo dpkg -l | grep elasticsearch #æŸ¥çœ‹å®‰è£…å…³è” sudo dpkg -L elasticsearch #ç§»é™¤å®‰è£…è½¯ä»¶ sudo dpkg -P elasticsearch #ç»§ç»­æŸ¥çœ‹æœªå¸è½½çš„ç›®å½•å’Œæ–‡ä»¶ sudo find / -name elasticsearch #ç§»é™¤ç›®å½•å’Œæ–‡ä»¶å…·ä½“å‚è€ƒè‡ªå·±çš„ç¯å¢ƒ sudo rm -rf /var/lib/elasticsearch \u0026amp;\u0026amp; sudo rm -rf /var/lib/dpkg/info/elasticsearch.* \u0026amp;\u0026amp; sudo rm -rf /etc/default/elasticsearch \u0026amp;\u0026amp; sudo rm -rf /etc/init.d/elasticsearch \u0026amp;\u0026amp; sudo rm -rf /var/log/elasticsearch \u0026amp;\u0026amp; sudo rm -rf /usr/share/elasticsearch #åœ¨æ­¤æŸ¥çœ‹æ˜¯å¦æœ‰å…³è”çš„ç›®å½•å’Œæ–‡ä»¶ sudo find / -name elasticsearch Logstash å®‰è£… Logstash ä¸‹è½½å®‰è£…å…¬å…±ç­¾å\nsudo wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add - æ¥ä¸‹å®‰è£… apt-transport-https åŒ…\nsudo apt-get install apt-transport-https å°†å­˜å‚¨åº“ä¿å­˜åˆ° /etc/apt/sources.list.d/elastic-8.x.list\necho \u0026#34;deb https://artifacts.elastic.co/packages/8.x/apt stable main\u0026#34; | sudo tee -a /etc/apt/sources.list.d/elastic-8.x.list ç„¶åä½ å°±èƒ½å®‰è£…Elasticsearchäº†\nsudo apt-get update \u0026amp;\u0026amp; sudo apt-get install logstash æ’ä»¶åœ°å€ https://www.elastic.co/guide/en/logstash-versioned-plugins/current/index.html é…ç½®è¡¨å­—æ®µè§£é‡Š https://blog.csdn.net/weixin_42073629/article/details/110154037?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~aggregatepage~first_rank_ecpm_v1~rank_v31_ecpm-1-110154037.pc_agg_new_rank\u0026amp;utm_term=logstash%E5%8F%82%E6%95%B0convert\u0026amp;spm=1000.2123.3001.4430 æŸ¥çœ‹å®‰è£…çš„æ’ä»¶ sudo /usr/share/logstash/bin/logstash-plugin list å¯åŠ¨Lostash ä¿®æ”¹ logstash.yml é…ç½®\nsudo vim /etc/logstash/logstash.yml å¯¼å…¥æ•°æ®[åˆ©ç”¨logstash ç›´æ¥åˆ†æmovies.csv ä¼ é€ç»™elasticsearchæ–¹å¼] â€‹\tæ”¶é›†æµç¨‹: movies.csv-\u0026gt;logstash-\u0026gt;elasticdearch-\u0026gt;grafana\nä¸‹è½½ml-latest.zip æ•°æ®\nsudo wget https://files.grouplens.org/datasets/movielens/ml-latest.zip è§£å‹ ml-latest.zip\nsudo unzip ml-latest.zip åœ¨/etc/logstash ç›®å½•ä¸‹åˆ›å»ºlogstash.conf æ–‡ä»¶\nsudo vim /etc/logstash/logstash.conf æŠŠä»¥ä¸‹å†…å®¹å†™å…¥logstash.conf\ninput { file { #ç›‘å¬æ–‡ä»¶çš„è·¯å¾„ path =\u0026gt; \u0026#34;/home/hls/downs/ml-latest/movies.csv\u0026#34; #ç›‘å¬æ–‡ä»¶çš„èµ·å§‹ä½ç½®ï¼Œé»˜è®¤æ˜¯end start_position =\u0026gt; \u0026#34;beginning\u0026#34; #ç›‘å¬æ–‡ä»¶è¯»å–ä¿¡æ¯è®°å½•çš„ä½ç½® sincedb_path =\u0026gt; \u0026#34;/home/hls/downs/ml-latest/db_path.log\u0026#34; } } filter { csv { separator =\u0026gt; \u0026#34;,\u0026#34; columns =\u0026gt; [\u0026#34;id\u0026#34;,\u0026#34;content\u0026#34;,\u0026#34;genre\u0026#34;,\u0026#34;@timestamp\u0026#34;] } mutate { # split =\u0026gt; { \u0026#34;genre\u0026#34; =\u0026gt; \u0026#34;|\u0026#34; } # remove_field =\u0026gt; [\u0026#34;path\u0026#34;, \u0026#34;host\u0026#34;,\u0026#34;@timestamp\u0026#34;,\u0026#34;message\u0026#34;] #åˆ é™¤æ— ç”¨å­—æ®µ } mutate { split =\u0026gt; [\u0026#34;content\u0026#34;, \u0026#34;(\u0026#34;] #å·¦æ‹¬å·åˆ†å‰² add_field =\u0026gt; { \u0026#34;title\u0026#34; =\u0026gt; \u0026#34;%{[content][0]}\u0026#34;} #å¢åŠ å­—æ®µ add_field =\u0026gt; { \u0026#34;year\u0026#34; =\u0026gt; \u0026#34;%{[content][1]}\u0026#34;} #å¢åŠ å­—æ®µ } mutate { convert =\u0026gt; { #year è½¬æ¢æˆæ•´å‹ \u0026#34;year\u0026#34; =\u0026gt; \u0026#34;integer\u0026#34; } strip =\u0026gt; [\u0026#34;title\u0026#34;] #å»æ‰å­—æ®µé¦–å°¾çš„ç©ºæ ¼ # remove_field =\u0026gt; [\u0026#34;path\u0026#34;, \u0026#34;host\u0026#34;,\u0026#34;@timestamp\u0026#34;,\u0026#34;message\u0026#34;,\u0026#34;content\u0026#34;] #åˆ é™¤æ— ç”¨å­—æ®µ } } output { elasticsearch { # åŒå¼•å·ä¸­çš„å†…å®¹ä¸ºESçš„åœ°å€ï¼Œè§†å®é™…æƒ…å†µè€Œå®š hosts =\u0026gt; \u0026#34;http://192.168.70.131:9200\u0026#34; index =\u0026gt; \u0026#34;movies\u0026#34; document_id =\u0026gt; \u0026#34;%{id}\u0026#34; #docId ç­‰ä»·äº_id å­—æ®µ } stdout {} } å¦‚æœéœ€è¦é‡æ–°å¯¼å…¥ï¼Œå…ˆåˆ é™¤db_path.log æ–‡ä»¶\nsudo rm -rf /var/lib/logstash/.lock sudo rm -rf /home/hls/downs/ml-latest/db_path.log sudo /usr/share/logstash/bin/logstash -f /etc/logstash/logstash.conf æŠ¥é”™\næ‰§è¡Œå‘½ä»¤**sudo /usr/share/logstash/bin/logstash -f /etc/logstash/logstash.conf** åå¦‚æœæŠ¥é”™\nWARNING: Could not find logstash.yml which is typically located in $LS_HOME/config or /etc/logstash. You can specify the path using --path.settings. Continuing using the defaults é‚£ä¹ˆå°±åˆ›å»ºè½¯è¿æ¥\ncd /usr/share/logstash sudo ln -s /etc/logstash ./config æ‰§è¡Œå‘½ä»¤**sudo /usr/share/logstash/bin/logstash -f /etc/logstash/logstash.conf** åå¦‚æœæŠ¥é”™\nLogstash could not be started because there is already another instance using the configured data directory. If you wish to run multiple instances, you must change the \u0026#34;path.data\u0026#34; setting. é‚£ä¹ˆå°±å» logstash.yml ä¸­path.data æŒ‡å®šçš„è·¯å¾„ä¸Šå»åˆ é™¤.lockæ–‡ä»¶\ncd /var/lib/logstash sudo ls -a sudo rm -rf .lock æˆ–è€…ç›´æ¥ä¸€å¥è¯\nsudo rm -rf /var/lib/logstash/.lock å¼ºåˆ¶æŸ¥çœ‹è¾“å‡º logstash.conf ä¿®æ”¹æˆä½ è‡ªå·±çš„æ–‡ä»¶ sudo /usr/share/logstash/bin/logstash /etc/logstash/logstash.conf --verbose --debug æŸ¥çœ‹æ•°æ® ç”¨Kibanaçš„å‘½ä»¤è¡Œå·¥å…·æ‰§è¡Œ GET _cat/indices å‘½ä»¤ï¼Œå°±èƒ½çœ‹è§å¯¼å…¥åˆ°Elasticsearchçš„ç´¢å¼•\nç”¨kibanaçš„å‘½ä»¤è¡Œå·¥å…·æ‰§è¡Œ**GET /lua_cpu_monitor-2022.06.03/_search**å‘½ä»¤,å°±èƒ½çœ‹è§å¯¼å…¥åˆ°Elasticsearchçš„æ•°æ®\nè‡ªåŠ¨é‡æ–°åŠ è½½é…ç½®å‘½ä»¤ logstash.conf ä¿®æ”¹æˆä½ è‡ªå·±çš„æ–‡ä»¶\nsudo /usr/share/logstash/bin/logstash /etc/logstash/logstash.conf --config.reload.automatic é»˜è®¤æ£€æµ‹æ—¶é—´æ˜¯**3**ç§’ å¯ä»¥é€šè¿‡ä¸‹åˆ—å‘½ä»¤ä¿®æ”¹ æŠŠ\u0026lt;\u0026gt;å·é‡Œé¢çš„2æ¢æˆä½ æƒ³è¦çš„æ—¶é—´\nsudo /usr/share/logstash/bin/logstash /etc/logstash/logstash.conf --config.reload.interval \u0026lt;2\u0026gt; å¸è½½Logstash # æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶ sudo dpkg -l | grep logstash #æŸ¥çœ‹å®‰è£…å…³è” sudo dpkg -L logstash #ç§»é™¤å®‰è£…è½¯ä»¶ sudo dpkg -P logstash #ç»§ç»­æŸ¥çœ‹æœªå¸è½½çš„ç›®å½•å’Œæ–‡ä»¶ sudo find / -name logstash #ç§»é™¤ç›®å½•å’Œæ–‡ä»¶å…·ä½“å‚è€ƒè‡ªå·±çš„ç¯å¢ƒ sudo rm -rf /var/lib/logstash \u0026amp;\u0026amp; sudo rm -rf /var/lib/dpkg/info/logstash.* \u0026amp;\u0026amp; sudo rm -rf /etc/default/logstash \u0026amp;\u0026amp; sudo rm -rf /etc/init.d/logstash \u0026amp;\u0026amp; sudo rm -rf /etc/logstash \u0026amp;\u0026amp; sudo rm -rf /var/log/logstash \u0026amp;\u0026amp; sudo rm -rf /usr/share/logstash #åœ¨æ­¤æŸ¥çœ‹æ˜¯å¦æœ‰å…³è”çš„ç›®å½•å’Œæ–‡ä»¶ sudo find / -name logstash Kibana å®‰è£…Kibana ä¸‹è½½å®‰è£…å…¬å…±ç­¾å\nwget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add - æ¥ä¸‹å®‰è£… apt-transport-https åŒ…\nsudo apt-get install apt-transport-https å°†å­˜å‚¨åº“ä¿å­˜åˆ° /etc/apt/sources.list.d/elastic-8.x.list\necho \u0026#34;deb https://artifacts.elastic.co/packages/8.x/apt stable main\u0026#34; | sudo tee -a /etc/apt/sources.list.d/elastic-8.x.list ç„¶åä½ å°±èƒ½å®‰è£…Kibanaäº†\nsudo apt-get update \u0026amp;\u0026amp; sudo apt-get install kibana å¯åŠ¨Kibana æ‰“å¼€kibana.yml æ–‡æ¡£\nsudo vim /etc/kibana/kibana.yml ä¿®æ”¹ server.port,server.host å­—æ®µ\nå¯åŠ¨\nsudo systemctl start kibana.service è‡ªå¯åŠ¨\nsudo systemctl enable kibana.service æŸ¥çœ‹ kibanaæ—¥å¿—\nsudo vim /var/log/kibana ç”¨è°·æ­Œæˆ–è€…å¾®è½¯è‡ªå¸¦æµè§ˆå™¨æ‰“å¼€åœ°å€\nhttp://10.40.38.66:5601 å¸è½½Kibana # æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶ sudo dpkg -l | grep kibana #æŸ¥çœ‹å®‰è£…å…³è” sudo dpkg -L kibana #ç§»é™¤å®‰è£…è½¯ä»¶ sudo dpkg -P kibana #ç»§ç»­æŸ¥çœ‹æœªå¸è½½çš„ç›®å½•å’Œæ–‡ä»¶ sudo find / -name kibana #ç§»é™¤ç›®å½•å’Œæ–‡ä»¶å…·ä½“å‚è€ƒè‡ªå·±çš„ç¯å¢ƒ sudo rm -rf /var/lib/kibana \u0026amp;\u0026amp; sudo rm -rf /var/lib/dpkg/info/kibana.* \u0026amp;\u0026amp; sudo rm -rf /etc/kibana #åœ¨æ­¤æŸ¥çœ‹æ˜¯å¦æœ‰å…³è”çš„ç›®å½•å’Œæ–‡ä»¶ sudo find / -name kibana Filebeat æ­é…filebeatä¸»è¦ä½¿ç”¨æ”¶é›†nginxæ•°æ®, å’Œä¸Šé¢çš„åˆ©ç”¨logstashè§£æmovies.csvï¼Œç„¶åæ”¶é›†æ•°æ®ç»™elasticsearchçš„æ–¹å¼ä¸ä¸€æ ·\næ”¶é›†æµç¨‹: nginx-\u0026gt;filebeat-\u0026gt;logstash-\u0026gt;elasticdearch-\u0026gt;grafana\nå®‰è£…Filebeat sudo curl -L -O https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-8.2.2-amd64.deb sudo dpkg -i filebeat-8.2.2-amd64.deb ä¿®æ”¹ filebat.yml é…ç½®æ–‡ä»¶ sudo vim /etc/filebeat/filebeat.yml ä¿®æ”¹ä¸‹åˆ—å‡ é¡¹\n# ============================== Filebeat inputs =============================== filebeat.inputs: - type: filestream id: my-filestream-id enabled: true paths: - /home/hls/work/blueprint-server-runtime/log/lua_cpu_monitor.log tags: [\u0026#34;lua_cpu_monitor_log\u0026#34;] - type: filestream id: my-filestream-id enabled: true paths: - /home/hls/work/blueprint-server-runtime/log/lua_mem_monitor.log tags: [\u0026#34;lua_mem_monitor_log\u0026#34;] # ============================== Filebeat modules ============================== filebeat.config.modules: path: ${path.config}/modules.d/*.yml reload.enabled: false setup.template.settings: index.number_of_shards: 1 # ------------------------------ Logstash Output ------------------------------- output.logstash: # The Logstash hosts hosts: [\u0026#34;10.40.38.66:5555\u0026#34;] # ================================= Processors ================================= processors: - add_host_metadata: when.not.contains.tags: forwarded - add_cloud_metadata: ~ - add_docker_metadata: ~ - add_kubernetes_metadata: ~ æµ‹è¯•filebeatå¯åŠ¨åï¼ŒæŸ¥çœ‹ç›¸å…³è¾“å‡ºä¿¡æ¯ sudo filebeat -e -c /etc/filebeat/filebeat.yml -d \u0026#34;publish\u0026#34; åå°æ–¹å¼å¯åŠ¨filebeat nohup filebeat -e -c /etc/filebeat/filebeat.yml \u0026gt;/dev/null 2\u0026gt;\u0026amp;1 \u0026amp; #å°†æ‰€æœ‰æ ‡å‡†è¾“å‡ºåŠæ ‡å‡†é”™è¯¯è¾“å‡ºåˆ°/dev/nullç©ºè®¾å¤‡ï¼Œå³æ²¡æœ‰ä»»ä½•è¾“å‡º nohup filebeat -e -c /etc/filebeat/filebeat.yml \u0026gt; filebeat.log \u0026amp; åœæ­¢filebeat ps -ef | grep filebeat kill -9 è¿›ç¨‹å· å¯åŠ¨å‡ºç°çš„é—®é¢˜ æ‰§è¡Œå‘½ä»¤systemctl start filebeat.serviceå°±èƒ½å¤Ÿå¯åŠ¨äº†ã€‚è€Œåæ‰§è¡Œps -ef|grep filebeatæŸ¥çœ‹ä¸€ä¸‹\nèƒ½å¤Ÿçœ‹åˆ°å·²ç»å¯åŠ¨èƒœåˆ©äº†ï¼Œå¦‚æœä½ å‘ç°æ²¡æœ‰å¯åŠ¨æˆåŠŸï¼Œé‚£ä¹ˆå°±æ‰§è¡Œ cd /usr/binï¼Œåœ¨è¿™ä¸ªç›®å½•ä¸‹æ‰§è¡Œ./filebeat -c /etc/filebeat/filebeat.yml -eï¼Œè¿™æ ·ä¼šæé†’å…·ä½“çš„é”™è¯¯ä¿¡æ¯ã€‚è€Œç”¨systemctl start filebeat.serviceå¯åŠ¨çš„æ—¶å€™æ²¡æœ‰ä»»ä½•æé†’ï¼Œè¿åœ¨ /var/log/filebeat/ å’Œ /var/lib/filebeat/registry/filebeat/ éƒ½æ²¡æ‰¾åˆ°é”™è¯¯ä¿¡æ¯ï¼Œè¿™é‡Œå±å®æœ‰ç‚¹å‘ã€‚\né‡æ–°å¯åŠ¨å‘½ä»¤systemctl restart filebeat.service\nå»å®‰è£…logstashçš„æœºå™¨å¯åŠ¨logstash å¢åŠ  logstash_filebeat.conf æ–‡æ¡£\nsudo vim /etc/logstash/conf.d/logstash_filebeat.conf æŠŠä»¥ä¸‹å†…å®¹ç²˜è´´ä¸Šä¿å­˜\ninput { beats { port =\u0026gt; 5555 #è¿™ä¸ªåœ°å€ä¸èƒ½å’Œlogstash.yml é‡Œé¢çš„api.http.host: 9600 ä¸€æ ·ï¼Œè¦ä¸ä¼šå‡ºç°åœ°å€å·²ç»è¢«ç»‘å®šçš„é”™è¯¯ } } output { if \u0026#34;lua_cpu_monitor_log\u0026#34; in [tags] { elasticsearch { hosts =\u0026gt; [\u0026#34;10.40.38.66:9200\u0026#34;] index =\u0026gt; \u0026#34;lua_cpu_monitor-%{+YYYY.MM.dd}\u0026#34; } } if \u0026#34;lua_men_monitor_log\u0026#34; in [tags] { elasticsearch { hosts =\u0026gt; [\u0026#34;10.40.38.66:9200\u0026#34;] index =\u0026gt; \u0026#34;lua_men_monitor-%{+YYYY.MM.dd}\u0026#34; } } } é‡æ–°åŠ è½½æ–°çš„é…ç½®å¹¶å¯åŠ¨logstash\nå…ˆå¯åŠ¨logstashï¼Œç„¶ååœ¨å¯åŠ¨filebeatï¼Œä¸ç„¶çš„è¯filebeatä¼šæ‰¾ä¸åˆ°beatsæ’ä»¶çš„:5555ç«¯å£\nsudo rm -rf /var/lib/logstash/.lock sudo /usr/share/logstash/bin/logstash -f /etc/logstash/conf.d/logstash_filebeat.conf --verbose --debug ç”¨filebeat ç›‘æ§ nginx ä¿®æ”¹ nginx conf é…ç½®è¡¨\nsudo vim /usr/local/nginx/conf/nginx.conf åŠ å…¥å¦‚ä¸‹æ—¥å¿—æ ¼å¼\nlog_format main \u0026#39;{\u0026#34;@timestamp\u0026#34;:\u0026#34;$time_iso8601\u0026#34;,\u0026#39; \u0026#39;\u0026#34;@source\u0026#34;:\u0026#34;$server_addr\u0026#34;,\u0026#39; \u0026#39;\u0026#34;hostname\u0026#34;:\u0026#34;$hostname\u0026#34;,\u0026#39; \u0026#39;\u0026#34;ip\u0026#34;:\u0026#34;$remote_addr\u0026#34;,\u0026#39; \u0026#39;\u0026#34;client\u0026#34;:\u0026#34;$remote_addr\u0026#34;,\u0026#39; \u0026#39;\u0026#34;request_method\u0026#34;:\u0026#34;$request_method\u0026#34;,\u0026#39; \u0026#39;\u0026#34;scheme\u0026#34;:\u0026#34;$scheme\u0026#34;,\u0026#39; \u0026#39;\u0026#34;domain\u0026#34;:\u0026#34;$server_name\u0026#34;,\u0026#39; \u0026#39;\u0026#34;referer\u0026#34;:\u0026#34;$http_referer\u0026#34;,\u0026#39; \u0026#39;\u0026#34;request\u0026#34;:\u0026#34;$request_uri\u0026#34;,\u0026#39; \u0026#39;\u0026#34;args\u0026#34;:\u0026#34;$args\u0026#34;,\u0026#39; \u0026#39;\u0026#34;size\u0026#34;:$body_bytes_sent,\u0026#39; \u0026#39;\u0026#34;status\u0026#34;: $status,\u0026#39; \u0026#39;\u0026#34;responsetime\u0026#34;:$request_time,\u0026#39; \u0026#39;\u0026#34;upstreamtime\u0026#34;:\u0026#34;$upstream_response_time\u0026#34;,\u0026#39; \u0026#39;\u0026#34;upstreamaddr\u0026#34;:\u0026#34;$upstream_addr\u0026#34;,\u0026#39; \u0026#39;\u0026#34;http_user_agent\u0026#34;:\u0026#34;$http_user_agent\u0026#34;,\u0026#39; \u0026#39;\u0026#34;https\u0026#34;:\u0026#34;$https\u0026#34;\u0026#39; \u0026#39;}\u0026#39;; å¯¹æ¯”ä¿®æ”¹ä¸‹å›¾å¯¹åº”çš„3ä¸ªçº¢æ¡†åœ°æ–¹\né‡å¯ nginx\nsudo pkill -9 nginx \u0026amp;\u0026amp; sudo nginx ç”¨ http:192.168.70.132:7000 ç™»å½•nginx ç½‘ç«™ç”Ÿæˆç™»å½•æ—¥å¿—ï¼Œç„¶åæ‰“å¼€ access.log æ—¥å¿—\nsudo vim /usr/local/nginx/logs/access.log sudo tail -f /usr/local/nginx/logs/access.log å¸è½½Filebeat # æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶ sudo dpkg -l | grep filebeat #æŸ¥çœ‹å®‰è£…å…³è” sudo dpkg -L filebeat #ç§»é™¤å®‰è£…è½¯ä»¶ sudo dpkg -P filebeat #ç»§ç»­æŸ¥çœ‹æœªå¸è½½çš„ç›®å½•å’Œæ–‡ä»¶ sudo find / -name filebeat #ç§»é™¤ç›®å½•å’Œæ–‡ä»¶å…·ä½“å‚è€ƒè‡ªå·±çš„ç¯å¢ƒ sudo rm -rf /var/lib/filebeat \u0026amp;\u0026amp; sudo rm -rf /var/log/filebeat/filebeat \u0026amp;\u0026amp; sudo rm -rf /var/log/filebeat \u0026amp;\u0026amp; sudo rm -rf /usr/share/filebeat #åœ¨æ­¤æŸ¥çœ‹æ˜¯å¦æœ‰å…³è”çš„ç›®å½•å’Œæ–‡ä»¶ sudo find / -name filebeat ","permalink":"https://frog-game.github.io/posts/blog/zabbix-mysql8.0/","summary":"å®‰è£…ç¯å¢ƒ ç‰ˆæœ¬ Ubuntu 20.04 zabbix 6.0 mysql 8.0 zabbix 6.0 é˜¿é‡Œäº‘é•œåƒåœ°å€ https://mirrors.aliyun.com/zabbix/zabbix/6.0/ubuntu/pool/main/z/zabbix-release/ ä¸‹è½½ zabbix sudo wget https://repo.zabbix.com/zabbix/6.0/ubuntu/pool/main/z/zabbix-release/zabbix-release_6.0-1+ubuntu20.04_all.deb sudo dpkg -i zabbix-release_6.0-1+ubuntu20.04_all.deb sudo apt update å®‰è£…Zabbix serverï¼ŒWebå‰ç«¯ï¼Œagent sudo apt install zabbix-server-mysql zabbix-frontend-php zabbix-apache-conf zabbix-sql-scripts zabbix-agent åˆ›","title":"Ubuntu20.04+mysql8.0+zabbix6.0+elk+filebeat+logstash+grafana æ¸¸æˆç›‘æ§æ—¥å¿—ç³»ç»Ÿéƒ¨ç½²"},{"content":"1. ç½‘ç»œç¼–ç¨‹æµç¨‹ 2. å µå¡IO 3. éå µå¡IO 4. ä¿¡å·é©±åŠ¨IO 5. å¼‚æ­¥ioæ¨¡å‹ 6. å¤šè·¯å¤ç”¨ 7. å•reactor ä»£è¡¨ä½œï¼šredis å†…å­˜æ•°æ®åº“\næ³¨æ„ï¼šredis 6.0 ä»¥åæ˜¯å¤šçº¿ç¨‹\n8. å•reactor å¤šè¿›ç¨‹æ¨¡å‹ ä»£è¡¨ï¼šnginx\n9. å•reactoræ¨¡å‹ + ä»»åŠ¡é˜Ÿåˆ— + çº¿ç¨‹æ±  ä»£è¡¨ä½œ:skynet\n10. ä¸»ä» reactor ä»£è¡¨ä½œï¼šnetty\n11. å¤šreactor + å¤šçº¿ç¨‹ ä»£è¡¨ä½œï¼šmemcache\n12. å¤šreactor + å¤šçº¿ç¨‹ +åç¨‹æ±  ","permalink":"https://frog-game.github.io/posts/blog/wangluo_io_zhongjie/","summary":"1. ç½‘ç»œç¼–ç¨‹æµç¨‹ 2. å µå¡IO 3. éå µå¡IO 4. ä¿¡å·é©±åŠ¨IO 5. å¼‚æ­¥ioæ¨¡å‹ 6. å¤šè·¯å¤ç”¨ 7. å•reactor ä»£è¡¨ä½œï¼šredis å†…å­˜æ•°æ®åº“ æ³¨æ„ï¼šredis 6.0 ä»¥","title":"ç½‘ç»œIOæ¨¡å‹æ€»ç»“"},{"content":" frog\u0026#39;s Blog ä¸€ä¸ªè®°å½•æŠ€æœ¯ã€é˜…è¯»ã€ç”Ÿæ´»çš„åšå®¢ åç§°ï¼š frog\u0026rsquo;s Blog ç½‘å€ï¼š https://frog-game.github.io/ æè¿° ä¸€ä¸ªè®°å½•ç”Ÿæ´»ï¼ŒæŠ€æœ¯çš„åšå®¢ ","permalink":"https://frog-game.github.io/links/","summary":"frog\u0026#39;s Blog ä¸€ä¸ªè®°å½•æŠ€æœ¯ã€é˜…è¯»ã€ç”Ÿæ´»çš„åšå®¢ åç§°ï¼š frog\u0026rsquo;s Blog ç½‘å€ï¼š https://frog-game.github.io/ æè¿° ä¸€ä¸ªè®°å½•ç”Ÿæ´»ï¼ŒæŠ€æœ¯çš„åšå®¢","title":"ğŸ¤å‹é“¾"},{"content":"å…³äºæˆ‘\nè‹±æ–‡å: frog èŒä¸š: ç å†œ è¿åŠ¨: è·‘æ­¥ã€ä¹’ä¹“çƒã€çˆ¬å±± ","permalink":"https://frog-game.github.io/about/","summary":"å…³äºæˆ‘ è‹±æ–‡å: frog èŒä¸š: ç å†œ è¿åŠ¨: è·‘æ­¥ã€ä¹’ä¹“çƒã€çˆ¬å±±","title":"ğŸ™‹ğŸ»â€â™‚ï¸å…³äº"}]